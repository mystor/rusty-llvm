Rusty LLVM
==========

Rusty LLVM aims to, someday, be a set of "safe" bindings to the llvm libraries from rust.

Implementation
--------------

Currently Rusty LLVM is written as a wrapper around `librustc_llvm`, which is the set of C bindings to LLVM-C which are used by `rustc`. The system works by casting the raw pointers which are returned from `librustc_llvm` into either `Box<EmptyEnum>` or `Option<&EmptyEnum>` depending on whether or not the function assumes that the caller takes ownership of the object. `EmptyEnum` then has `Drop` implemented for it, which calls the destructor in the C api when the box is destroyed.

A short list of some things I don't like about this implementation:
- Way too much `mem::transmute` for me to feel comfortable with myself
- All references are shared references `&Context` rather than exclusive references `&mut Context` even though the context can be mutated (this is because I'm pretty sure that if references were exclusive, the API would be almost impossible to use).

If someone has an idea on a better way to implement the interface which will allow me to not feel like I'm making a dark pact every time I write `mem::transmute`, I'm *very* open to hearing it.

Plans
-----

The eventual goal isn't just to make it so your code doesn't have `unsafe { }` everywhere when you use llvm, but also to get back some of the type safety which is provided by the C++ API, but not the C api.

- Tracking of lifetimes of references, to prevent references from living longer than the object they are from
- Re-introduce `ConstantValue` and similar which have the methods which only work on constant values, allowing for improved safety (can't call `ConstantValue` methods on arbitrary `Value`s)
- Re-name the methods/functions to take advantage of the fact that rust actually has namespaces

Contributing
------------

Right now, the most useful way in which you could contribute is to flip through the absurd number of functions, and make sure that I didn't bugger anything up with the "safe" bindings. Right now almost all of the bindings are either generated by a crappy python script, or unimplemented, so don't be surprised if parameter lists are too restrictive/not restrictive enough
